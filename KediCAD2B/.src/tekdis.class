' Gambas class file

Public v As Float
Public d As Float
Public c As Float
Public z As Float
Public p As Float
Public ksi As Float
Public onmod As Float
Public amod As Integer
Public acap As Integer
Public almod As Float
Public t1 As Float
Public t2 As Float
Public t3 As Float
Public t4 As Float
Public radi1 As Float
Public radi2 As Float
Public radi3 As Float
Public radi4 As Float
Public radi5 As Float
Public mod1 As Float
Public mod2 As Float
Public mod3 As Float
Public mod4 As Float
Public mod5 As Float
Public tks1 As Float
Public tks2 As Float
Public tks3 As Float
Public tks4 As Float
Public kes1 As Float
Public kes2 As Float
Public kes3 As Float
Public kes4 As Float
Public hea1 As Float
Public hea2 As Float
Public hea3 As Float
Public hea4 As Float
Public pin1 As Float
Public pin2 As Float
Public pin3 As Float
Public pin4 As Float
Public ptaksim1 As Float
Public ptaksim2 As Float
Public ptaksim3 As Float
Public ptaksim4 As Float
Public ctaksim1 As Float
Public ctaksim2 As Float
Public ctaksim3 As Float
Public ctaksim4 As Float

Public Sub Button3_Click()

    Dim dosya As String

    Dim myFile As File

    If Dialog.SaveFile() Then Return
    dosya = File.Name(Dialog.Path)
    myFile = Open System.User.Home &/ dosya & ".txt" For Create
    Print #myFile, "   DİŞLİ HESAPLARI SONUÇLARI"
    Print #myFile, "   "
    Print #myFile, "   VERİLER "
    Print #myFile, "Dişli Çeşidi :  " & csd.Text
    Print #myFile, "Dişli Yerleşimi :  " & yer.Text
    Print #myFile, "Dişli Malzemesi :  " & mlz.Text
    Print #myFile, "Zorlanma Şekli :  " & zor.Text
    Print #myFile, "Güç :  " & mlz.Text & " BG."
    Print #myFile, "Giriş Devri :  " & devir.Text & " d/d"
    Print #myFile, "Diş Sayısı :  " & sayi.Text & " Adet"
    Print #myFile, "Beta Açısı :  " & beta.Text & " Adet"
    Print #myFile, "   "
    Print #myFile, "   SONUÇLAR"
    Print #myFile, "Normal Modül :  " & mod.Text & " mm."
    Print #myFile, "Diş Adımı :  " & adim.Text & " mm."
    Print #myFile, "Bölüm Dairesi Çapı :  " & bdc.Text & " mm."
    Print #myFile, "Diş Dibi Çapı :  " & ddc.Text & " mm."
    Print #myFile, "Diş Üstü Çapı :  " & duc.Text & " mm."
    Print #myFile, "Diş Kalınlığı :  " & kalin.Text & " mm."
    Print #myFile, "Diş Yüksekliği :  " & yuksek.Text & " mm."
    Print #myFile, "Diş Genişliği :  " & genis.Text & " mm."
    Print #myFile, "Çevresel Hız :  " & chiz.Text & " m/sn."
    Print #myFile, "Diş Basınç Kuvveti :  " & yuk.Text & " kgf."
    Print #myFile, "Dödürme Momenti :  " & mom.Text & " kgf.cm."
    Print #myFile, "Mil Çapı :  " & mcap.Text & " mm."
    Print #myFile, "Alın Modülü :  " & alinm.Text & " mm."
    Print #myFile, "Helis Açısı :  " & haci.Text
    Print #myFile, "Helis Adımı :  " & hadim.Text & " mm."
    Close myFile

End

Public Sub Button1_Click()

    If guc.Text = "" Or devir.Text = "" Or sayi.Text = "" Then
        message("Missing data", "OK")
        Goto cik
    End If
    If csd.Text = "Düz Dişli" Or csd.Text = "Konik Dişli" Then
        d = 10 * 14.4 * (Val(guc.Text) / Val(devir.Text)) ^ (1 / 3)
        acap = d
        If acap < d Then acap = acap + 1
        v = Pi * acap * Val(devir.Text) / 60000
        cci
        ksici
        p = 100 * (450 * Val(guc.Text) / (c * ksi * Val(sayi.Text) * Val(devir.Text))) ^ (1 / 3)
        amod = p / Pi
        onmod = p / Pi
        If onmod > amod Then amod = amod + 1
        mod.Text = amod
        adim.Text = Format$(p, "#.##")
        bdc.Text = Format$(Val(sayi.Text) * amod, "#.##")
        yuksek.Text = Format$(2.166 * amod, "#.##")
        If zor.Text = "Az yük" Or zor.Text = "Orta yük, Darbesiz" Then
            genis.Text = Format$(2 * p, "#.##")
        Else
            genis.Text = Format$(4 * p, "#.##")
        End If
        chiz.Text = Format$(v, "#.##")
        duc.Text = Format$(Val(bdc.Text) + 2 * amod, "#.##")
        ddc.Text = Format$(Val(bdc.Text) - (2 * 1.66 * amod), "#.##")
        kalin.Text = Format$(0.475 * p, "#.##")
        yuk.Text = Format$(71620 * Val(guc.Text) * 2 / (acap * Val(devir.Text)), "#.##")
        mom.Text = Format$(71620 * Val(guc.Text) / Val(devir.Text), "#.##")
        mcap.Text = Format$(acap, "#.##")
    End If
    If csd.Text = "Helisel" Then
        d = 14.4 * (Val(guc.Text) / Val(devir.Text)) ^ (1 / 3)
        acap = d
        If acap < d Then acap = acap + 1
        v = Pi * acap * Val(devir.Text) / 60000
        cci
        ksici
        p = 100 * (450 * Val(guc.Text) / (c * ksi * Val(sayi.Text) * Val(devir.Text))) ^ (1 / 3)
        amod = p / Pi
        onmod = p / Pi
        If onmod > amod Then amod = amod + 1
        mod.Text = amod
        alinm.text = Format$(amod / Cos(Val(beta.Text) * Pi / 180), "#.##")
        adim.Text = Format$(p, "#.##")
        aadim.Text = Format$(p / Cos(Val(beta.Text) * Pi / 180), "#.##")
        almod = p / Cos(Val(beta.Text) * Pi / 180)

        bdc.Text = Format$(Val(sayi.Text) * almod, "#.##")
        yuksek.Text = Format$(2.166 * amod, "#.##")
        If zor.Text = "Az yük" Or zor.Text = "Orta yük, Darbesiz" Then
            genis.Text = Format$(2 * p, "#.##")
        Else
            genis.Text = Format$(4 * p, "#.##")
        End If
        chiz.Text = Format$(v, "#.##")
        duc.Text = Format$(Val(bdc.Text) + 2 * amod, "#.##")
        ddc.Text = Format$(Val(bdc.Text) - (2 * 1.66 * amod), "#.##")
        kalin.Text = Format$(0.475 * p, "#.##")
        yuk.Text = Format$(71620 * Val(guc.Text) * 2 / (acap * Val(devir.Text)), "#.##")
        mom.Text = Format$(71620 * Val(guc.Text) / Val(devir.Text), "#.##")
        mcap.Text = Format$(acap, "#.##")
        hadim.Text = Format$(Val(bdc.Text) * Pi / (Tan(Val(beta.Text) * Pi / 180)), "#.##")
        haci.Text = Format$(Atn(Val(hadim.Text) * Pi / 180 / (Pi * Val(bdc.Text) * Pi / 180)), "#.##")
    End If
cik:

End

Public Sub csd_Change()

    If csd.Text = "Helisel" Then
        label19.Visible = True
        beta.Visible = True
    Else
        label19.Visible = False
        beta.Visible = False
    End If

End

Public Sub Button2_Click()

    guc.Text = ""
    devir.Text = ""
    beta.Text = ""
    mod.Text = ""
    adim.Text = ""
    bdc.Text = ""
    yuksek.Text = ""
    genis.Text = ""
    chiz.Text = ""
    duc.Text = ""
    ddc.Text = ""
    yuk.Text = ""
    mom.Text = ""
    mcap.Text = ""
    mom.Text = ""
    kalin.Text = ""
    sayi.Text = ""
    beta.Text = ""
    haci.Text = ""
    hadim.Text = ""
    aadim.Text = ""

End

Public Sub ksici()

    If zor.Text = "Az yük" Then ksi = 5
    If zor.Text = "Orta yük, Darbesiz" Then ksi = 4
    If zor.Text = "Orta yük, Darbeli" Then ksi = 3
    If zor.Text = "Büyük yük, Darbeli" Then ksi = 2
    Return

End

Public Sub cci()

    If mlz.Text = "Esmer Font" Then
        If v < 0.25 Then c = 27
        If v > 0.25 And v < 0.50 Then c = 27
        If v > 0.50 And v < 1 Then c = 26
        If v > 1 And v < 2 Then c = 23
        If v > 2 And v < 3 Then c = 21
        If v > 3 And v < 4 Then c = 19
        If v > 4 And v < 5 Then c = 18
        If v > 5 And 6 Then c = 17
        If v > 6 And v < 7 Then c = 16
        If v > 7 And v < 8 Then c = 14
        If v > 8 And v < 9 Then c = 13
        If v > 9 And v < 10 Then c = 12
        If v > 10 And v < 11 Then c = 11
        If v > 12 And v < 15 Then c = 10
        If v > 15 Then c = 100
    End If
    If mlz.Text = "Dökme Çelik" Then
        If v < 0.25 Then c = 56
        If v > 0.25 And v < 0.50 Then c = 54
        If v > 0.50 And v < 1 Then c = 52
        If v > 1 And v < 2 Then c = 46
        If v > 2 And v < 3 Then c = 42
        If v > 3 And v < 4 Then c = 38
        If v > 4 And v < 5 Then c = 36
        If v > 5 And 6 Then c = 34
        If v > 6 And v < 7 Then c = 32
        If v > 7 And v < 8 Then c = 28
        If v > 8 And v < 9 Then c = 26
        If v > 9 And v < 10 Then c = 24
        If v > 10 And v < 11 Then c = 22
        If v > 12 And v < 15 Then c = 20
        If v > 15 Then c = 100
    End If
    If mlz.Text = "St Çeliği" Then
        If v < 0.25 Then c = 84
        If v > 0.25 And v < 0.50 Then c = 81
        If v > 0.50 And v < 1 Then c = 78
        If v > 1 And v < 2 Then c = 69
        If v > 2 And v < 3 Then c = 63
        If v > 3 And v < 4 Then c = 57
        If v > 4 And v < 5 Then c = 54
        If v > 5 And 6 Then c = 51
        If v > 6 And v < 7 Then c = 48
        If v > 7 And v < 8 Then c = 42
        If v > 8 And v < 9 Then c = 39
        If v > 9 And v < 10 Then c = 36
        If v > 10 And v < 11 Then c = 33
        If v > 12 And v < 15 Then c = 30
        If v > 15 Then c = 100
    End If
    If mlz.Text = "Alaşım Çeliği" Then
        If v < 0.25 Then c = 224
        If v > 0.25 And v < 0.50 Then c = 216
        If v > 0.50 And v < 1 Then c = 208
        If v > 1 And v < 2 Then c = 184
        If v > 2 And v < 3 Then c = 168
        If v > 3 And v < 4 Then c = 152
        If v > 4 And v < 5 Then c = 144
        If v > 5 And 6 Then c = 136
        If v > 6 And v < 7 Then c = 128
        If v > 7 And v < 8 Then c = 112
        If v > 8 And v < 9 Then c = 104
        If v > 9 And v < 10 Then c = 96
        If v > 10 And v < 11 Then c = 88
        If v > 12 And v < 15 Then c = 80
        If v > 15 Then c = 100
    End If
    If mlz.Text = "Fosfor Bronz" Then
        If v < 0.25 Then c = 48
        If v > 0.25 And v < 0.50 Then c = 46
        If v > 0.50 And v < 1 Then c = 44
        If v > 1 And v < 2 Then c = 39
        If v > 2 And v < 3 Then c = 36
        If v > 3 And v < 4 Then c = 32
        If v > 4 And v < 5 Then c = 31
        If v > 5 And 6 Then c = 29
        If v > 6 And v < 7 Then c = 27
        If v > 7 And v < 8 Then c = 24
        If v > 8 And v < 9 Then c = 22
        If v > 9 And v < 10 Then c = 20
        If v > 10 And v < 11 Then c = 19
        If v > 12 And v < 15 Then c = 17
        If v > 15 Then c = 100
    End If
    If mlz.Text = "Kızıl Döküm" Then
        If v < 0.25 Then c = 36
        If v > 0.25 And v < 0.50 Then c = 35
        If v > 0.50 And v < 1 Then c = 34
        If v > 1 And v < 2 Then c = 30
        If v > 2 And v < 3 Then c = 27
        If v > 3 And v < 4 Then c = 25
        If v > 4 And v < 5 Then c = 23
        If v > 5 And 6 Then c = 22
        If v > 6 And v < 7 Then c = 21
        If v > 7 And v < 8 Then c = 18
        If v > 8 And v < 9 Then c = 17
        If v > 9 And v < 10 Then c = 16
        If v > 10 And v < 11 Then c = 14
        If v > 12 And v < 15 Then c = 13
        If v > 15 Then c = 100
    End If
    Return

End

Public Sub Form_Open()

    csd.Add("Düz Dişli", 0)
    csd.Add("Helisel", 1)
    csd.Add("Konik Dişli", 2)
    csd.Add("Krameyer Dişli", 2)
    yer.Add("Dıştan Dişli", 0)
    yer.Add("İçten Dişli", 1)
    mlz.Add("Alaşım Çeliği", 0)
    mlz.Add("St Çeliği", 1)
    mlz.Add("Dökme Çelik", 2)
    mlz.Add("Fosfor Bronz", 3)
    mlz.Add("Kızıl Döküm", 4)
    mlz.Add("Esmer Font", 5)
    zor.Add("Az yük", 0)
    zor.Add("Orta yük, Darbesiz", 1)
    zor.Add("Orta yük, Darbeli", 2)
    zor.Add("Büyük yük, Darbeli", 3)

End
